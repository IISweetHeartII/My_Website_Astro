name: PR Preview Comment

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  comment:
    name: Add Cloudflare Preview Link
    runs-on: ubuntu-latest

    steps:
      - name: Comment PR
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const prNumber = context.issue.number;
            const repoName = context.repo.repo;
            const owner = context.repo.owner;

            const comment = `## ğŸš€ Preview Deployment

            ### Cloudflare Pages Preview
            Cloudflare PagesëŠ” ì´ PRì— ëŒ€í•œ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

            **Preview URL**: \`https://<commit-hash>.my-website-nextjs.pages.dev\`

            > Cloudflare Dashboardì—ì„œ ì •í™•í•œ URLì„ í™•ì¸í•˜ì„¸ìš”:
            > https://dash.cloudflare.com â†’ Workers & Pages â†’ Pages

            ### âœ… Checks
            - Build: In Progress...
            - Tests: In Progress...
            - Security: In Progress...

            PreviewëŠ” ì•½ 2-3ë¶„ í›„ì— ì¤€ë¹„ë©ë‹ˆë‹¤.`;

            github.rest.issues.createComment({
              issue_number: prNumber,
              owner: owner,
              repo: repoName,
              body: comment
            });
