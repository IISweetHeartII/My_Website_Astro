---
import { Award, ExternalLink, Github, Lock } from "lucide-astro";
import { AUTHOR_GITHUB } from "@/shared/config/consts";
import Layout from "../layouts/Layout.astro";

interface ProjectLink {
  label: string;
  url: string;
  icon: "github" | "external" | "lock";
}

interface Project {
  title: string;
  role: string;
  highlight: string;
  description: string;
  tags: string[];
  links: ProjectLink[];
  gradient: string;
  borderColor: string;
  featured?: boolean;
  screenshot?: string;
}

const projects: Project[] = [
  {
    title: "agentgram",
    role: "Core Contributor (ongoing)",
    highlight: "Open-Source AI Agent Social Network",
    description:
      "AI 에이전트들이 소통하는 오픈소스 소셜 네트워크. 멀티 레포 에코시스템으로 활발히 개발 중입니다.",
    tags: ["Open Source", "AI Agent", "Multi-Repo"],
    links: [
      {
        label: "GitHub",
        url: "https://github.com/agentgram/agentgram",
        icon: "github",
      },
      {
        label: "Live",
        url: "https://agentgram.co",
        icon: "external",
      },
    ],
    gradient: "from-indigo-500 to-blue-500",
    borderColor: "border-indigo-200",
    featured: true,
  },
  {
    title: "Finders",
    role: "Backend Lead (11-person team)",
    highlight: "GCP Infra + Code Review Culture",
    description:
      "필름 현상소 연결 플랫폼의 백엔드 리드. GCP 인프라 구축, 코드 리뷰 문화 정착, AI 기반 필름 복원 기능을 개발했습니다.",
    tags: ["Java 21", "Spring Boot", "GCP", "Docker", "QueryDSL"],
    links: [
      {
        label: "GitHub",
        url: "https://github.com/Finders-Official/BE",
        icon: "github",
      },
      {
        label: "Live",
        url: "https://finders.it.kr",
        icon: "external",
      },
    ],
    gradient: "from-sky-500 to-cyan-600",
    borderColor: "border-sky-200",
    featured: true,
  },
  {
    title: "UMC Hackathon Team4",
    role: "BE + FE Contributor",
    highlight: "Grand Prize Winner",
    description:
      "촉박한 일정 속에서 End-to-End MVP를 완성해 해커톤 대상을 수상했습니다. 기획부터 배포까지 전 과정에 참여했습니다.",
    tags: ["Hackathon", "Spring Boot", "Next.js", "Full-Stack"],
    links: [
      {
        label: "BE",
        url: "https://github.com/umc9-hackathon-team4/BE",
        icon: "github",
      },
      {
        label: "FE",
        url: "https://github.com/umc9-hackathon-team4/FE",
        icon: "github",
      },
    ],
    gradient: "from-amber-500 to-orange-600",
    borderColor: "border-amber-200",
  },
  {
    title: "119-ai",
    role: "Founder / Owner",
    highlight: "Personal Product + Patent Prep",
    description: "개인 제품으로 전환 중이며, 특허 출원을 준비하고 있습니다. 코드는 비공개입니다.",
    tags: ["AI", "Product", "Patent"],
    links: [
      {
        label: "Live",
        url: "https://emergency-ai-call.log8.kr",
        icon: "external",
      },
    ],
    gradient: "from-emerald-500 to-teal-600",
    borderColor: "border-emerald-200",
  },
  {
    title: "iCan Labs",
    role: "Founder / Owner",
    highlight: "AI Math Education Platform",
    description: "AI 기반 수학 교육 플랫폼. 학습자 맞춤형 문제 풀이와 시각화를 제공합니다.",
    tags: ["AI", "Education", "Math"],
    links: [
      {
        label: "Live",
        url: "https://mathfigure.log8.kr",
        icon: "external",
      },
    ],
    gradient: "from-sky-500 to-indigo-600",
    borderColor: "border-sky-200",
  },
  {
    title: "log8",
    role: "1-person Dev & Ops",
    highlight: "AI-Paired Tech Blog (This Site)",
    description:
      "지금 보고 계신 이 사이트. Astro + TailwindCSS v4로 구축하고, CI/CD 파이프라인과 AI 페어 프로그래밍으로 운영 중입니다.",
    tags: ["Astro", "TailwindCSS v4", "Cloudflare", "CI/CD"],
    links: [
      {
        label: "GitHub",
        url: "https://github.com/IISweetHeartII/My_Website_Astro",
        icon: "github",
      },
      {
        label: "Live",
        url: "https://log8.kr",
        icon: "external",
      },
    ],
    gradient: "from-indigo-500 to-sky-600",
    borderColor: "border-indigo-200",
  },
];

const featuredProjects = projects.filter((project) => project.featured);

function getOrderedLinks(links: ProjectLink[]): ProjectLink[] {
  const priority = {
    external: 0,
    github: 1,
    lock: 2,
  } as const;

  return [...links].sort((a, b) => priority[a.icon] - priority[b.icon]);
}

const iconMap = {
  github: Github,
  external: ExternalLink,
  lock: Lock,
};
---

<Layout title="Showcase | Log8" description="김덕환이 직접 설계하고 구현한 프로젝트 모음입니다. AI 제품, 인프라, 풀스택 개발 등 다양한 도메인의 실전 경험을 담았습니다.">
  <main class="max-w-5xl mx-auto px-6 py-16">
    <!-- Page Header -->
    <div class="text-center mb-16">
      <h1 class="text-4xl md:text-5xl font-bold text-text mb-4">Showcase</h1>
      <p class="text-lg text-text-light max-w-2xl mx-auto">
        실제 문제를 해결하기 위해 만든 프로젝트들
      </p>
      <div class="mt-6 flex flex-wrap justify-center gap-3">
        <a
          href="#featured-projects"
          data-cta-track
          data-cta-name="showcase_featured_jump"
          data-cta-section="showcase_header"
          class="inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-primary text-on-primary text-sm font-semibold hover:bg-accent transition-colors"
        >
          대표 프로젝트 먼저 보기
        </a>
        <a
          href="#all-projects"
          data-cta-track
          data-cta-name="showcase_all_jump"
          data-cta-section="showcase_header"
          class="inline-flex items-center gap-2 px-5 py-2.5 rounded-xl border border-background-lighter bg-background-light text-text text-sm font-semibold hover:border-primary/30 hover:bg-background transition-colors"
        >
          전체 프로젝트 둘러보기
        </a>
      </div>
    </div>

    <section id="featured-projects" class="mb-10">
      <div class="mb-4 flex items-center justify-between">
        <h2 class="text-xl md:text-2xl font-bold text-text">대표 프로젝트</h2>
        <span class="text-sm text-text-light">빠르게 핵심만 확인</span>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {
          featuredProjects.map((project) => (
            <article class={`group rounded-2xl border ${project.borderColor} bg-background-light overflow-hidden`}>
              {project.screenshot && (
                <div class="overflow-hidden">
                  <img
                    src={project.screenshot}
                    alt={`${project.title} 스크린샷`}
                    class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-500"
                    loading="lazy"
                  />
                </div>
              )}
              <div class="p-5">
              <p class="text-sm font-semibold text-primary mb-2">{project.role}</p>
              <h3 class="text-xl font-bold text-text mb-2">{project.title}</h3>
              <p class="text-sm text-text-light mb-4">{project.highlight}</p>
              <div class="flex items-center gap-2 flex-wrap">
                {getOrderedLinks(project.links).map((link) => {
                  const Icon = iconMap[link.icon];
                  return (
                    <a
                      href={link.url}
                      target="_blank"
                      rel="noopener noreferrer"
                      data-cta-track
                      data-cta-name={`featured_${project.title}_${link.label}`}
                      data-cta-section="showcase_featured"
                      class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-primary text-on-primary text-xs font-semibold hover:bg-accent transition-colors"
                    >
                      <Icon class="w-3.5 h-3.5" />
                      {link.label}
                    </a>
                  );
                })}
              </div>
              </div>
            </article>
          ))
        }
      </div>
    </section>

    <!-- Projects -->
    <div id="all-projects" class="space-y-6">
      {
        projects.map((project) => (
          <article
            class={`group bg-background rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden border dark:border-background-lighter ${project.borderColor}`}
          >
            <div class="flex flex-col md:flex-row">
              {/* Color accent bar */}
              <div
                class={`md:w-2 w-full h-2 md:h-auto bg-linear-to-b ${project.gradient} dark:opacity-75 shrink-0`}
              />

              <div class="flex-1">
                {project.screenshot && (
                  <div class="overflow-hidden">
                    <img
                      src={project.screenshot}
                      alt={`${project.title} 스크린샷`}
                      class="w-full h-56 object-cover group-hover:scale-105 transition-transform duration-500"
                      loading="lazy"
                    />
                  </div>
                )}
              <div class="p-6 md:p-8">
                {/* Header */}
                <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 mb-4">
                  <div>
                    <h2 class="text-2xl font-bold text-text group-hover:text-primary transition-colors">
                      {project.title}
                    </h2>
                    <p class="text-sm text-text-light mt-1">{project.role}</p>
                  </div>
                  <span
                    class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-background-light border border-background-lighter text-text-light text-xs font-semibold rounded-full whitespace-nowrap self-start"
                  >
                    {project.featured && <Award class="w-3.5 h-3.5" />}
                    {project.highlight}
                  </span>
                </div>

                {/* Description */}
                <p class="text-text-light leading-relaxed mb-5">
                  {project.description}
                </p>

                {/* Tags + Links */}
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                  <div class="flex flex-wrap gap-2">
                    {project.tags.map((tag) => (
                      <span class="px-3 py-1 bg-background-muted text-text-muted text-xs font-medium rounded-full">
                        {tag}
                      </span>
                    ))}
                  </div>

                  <div class="flex items-center gap-3 shrink-0">
                    {getOrderedLinks(project.links).map((link) => {
                      const Icon = iconMap[link.icon];
                      return (
                        <a
                          href={link.url}
                          target="_blank"
                          rel="noopener noreferrer"
                          data-cta-track
                          data-cta-name={`project_${project.title}_${link.label}`}
                          data-cta-section="showcase_projects"
                          class="inline-flex items-center gap-1.5 px-4 py-2 bg-background-light border border-background-lighter hover:border-primary text-text hover:text-primary text-sm font-medium rounded-lg transition-all duration-200 hover:-translate-y-0.5"
                        >
                          <Icon class="w-4 h-4" />
                          {link.label}
                        </a>
                      );
                    })}
                  </div>
                </div>
              </div>
              </div>
            </div>
          </article>
        ))
      }
    </div>

    <!-- GitHub CTA -->
      <section class="mt-16 text-center">
        <div
          class="inline-flex flex-col items-center gap-4 p-8 bg-background-light rounded-2xl border border-background-lighter"
        >
          <p class="text-text-light">
            더 많은 프로젝트와 기여 내역은 GitHub에서 확인하세요
          </p>
        <a
          href={AUTHOR_GITHUB}
          target="_blank"
          rel="noopener noreferrer"
          data-cta-track
          data-cta-name="showcase_github_profile"
          data-cta-section="showcase_footer"
          class="inline-flex items-center gap-2 px-6 py-3 bg-background-light border border-background-lighter hover:border-primary text-text hover:text-primary font-semibold rounded-xl transition-all duration-300 hover:-translate-y-0.5 hover:shadow-lg"
        >
          <Github class="w-5 h-5" />
          GitHub Profile
        </a>
      </div>
    </section>
  </main>
</Layout>
