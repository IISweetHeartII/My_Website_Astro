---
import { Github, Linkedin, Mail, Menu, Moon, Sun, X } from "lucide-astro";
import { AUTHOR_EMAIL, AUTHOR_GITHUB, AUTHOR_LINKEDIN, SITE_TITLE } from "@/shared/config/consts";
import { getUrl } from "@/shared/utils/url";
import HeaderLink from "./HeaderLink.astro";
---

<header
  id="main-header"
  class="sticky top-0 z-50 bg-nav border-b border-nav-border transition-all duration-300"
>
  <nav class="container mx-auto px-4 h-16 flex items-center justify-between">
    <div class="flex items-center">
      <a
        href={getUrl("/")}
        class="flex items-center space-x-2 text-nav-text font-semibold text-lg hover:text-accent transition-colors duration-200 hover:bg-nav-hover/20 rounded px-2 -ml-2 py-1"
      >
        <img
          src={getUrl("/images/design/icon.png")}
          alt="Log8 Icon"
          class="w-6 h-6 rounded-md hover:scale-105 transition-transform duration-300"
        />
        <span>{SITE_TITLE}</span>
      </a>
    </div>

    <div class="hidden md:flex items-center space-x-6">
      <HeaderLink href={getUrl("/blog")}>Blog</HeaderLink>
      <HeaderLink href={getUrl("/showcase")}>Showcase</HeaderLink>
      <HeaderLink href={getUrl("/portfolio")}>Portfolio</HeaderLink>
      <HeaderLink href={getUrl("/resume")}>Resume</HeaderLink>
    </div>

    <div class="flex items-center space-x-2">
      <button
        id="theme-toggle"
        type="button"
        class="inline-flex items-center justify-center w-9 h-9 text-nav-text/80 hover:text-nav-text hover:bg-nav-hover/20 rounded-lg transition-all duration-200"
        aria-label="테마 전환"
        aria-pressed="false"
      >
        <Sun data-icon="sun" class="w-5 h-5 hidden" />
        <Moon data-icon="moon" class="w-5 h-5" />
      </button>

      <!-- Social Icons -->
      <a
        href={AUTHOR_GITHUB}
        target="_blank"
        rel="noopener noreferrer"
        class="hidden md:inline-flex items-center justify-center w-9 h-9 text-nav-text/80 hover:text-nav-text hover:bg-nav-hover/20 rounded-lg transition-all duration-200"
        title="GitHub"
      >
        <Github class="w-5 h-5" />
      </a>
      <a
        href={AUTHOR_LINKEDIN}
        target="_blank"
        rel="noopener noreferrer"
        class="hidden md:inline-flex items-center justify-center w-9 h-9 text-nav-text/80 hover:text-nav-text hover:bg-nav-hover/20 rounded-lg transition-all duration-200"
        title="LinkedIn"
      >
        <Linkedin class="w-5 h-5" />
      </a>
      <a
        href={`mailto:${AUTHOR_EMAIL}`}
        class="hidden md:inline-flex items-center justify-center w-9 h-9 text-nav-text/80 hover:text-nav-text hover:bg-nav-hover/20 rounded-lg transition-all duration-200"
        title="Email"
      >
        <Mail class="w-5 h-5" />
      </a>

      <!-- Mobile menu toggle button -->
      <button class="md:hidden text-nav-text focus:outline-none" id="mobile-menu-toggle">
        <Menu class="w-6 h-6" />
      </button>
    </div>
  </nav>

  <!-- Mobile menu content (initially hidden) -->
  <div
    class="md:hidden fixed inset-0 bg-nav/95 z-40 transition-transform duration-300 ease-in-out transform translate-x-full"
    id="mobile-menu"
  >
    <div class="flex justify-end p-4">
      <button class="text-nav-text focus:outline-none" id="mobile-menu-close">
        <X class="w-6 h-6" />
      </button>
    </div>
    <nav class="flex flex-col items-center space-y-6 py-8">
      <a
        href={getUrl("/blog")}
        class="text-nav-text hover:text-accent text-xl font-semibold transition-colors duration-200"
        >Blog</a
      >
      <a
        href={getUrl("/showcase")}
        class="text-nav-text hover:text-accent text-xl font-semibold transition-colors duration-200"
        >Showcase</a
      >
      <a
        href={getUrl("/portfolio")}
        class="text-nav-text hover:text-accent text-xl font-semibold transition-colors duration-200"
        >Portfolio</a
      >
      <a
        href={getUrl("/resume")}
        class="text-nav-text hover:text-accent text-xl font-semibold transition-colors duration-200"
        >Resume</a
      >
      <!-- Mobile social links -->
      <div class="flex items-center space-x-4 pt-4 border-t border-nav-text/20">
        <a
          href={AUTHOR_GITHUB}
          target="_blank"
          rel="noopener noreferrer"
          class="text-nav-text/80 hover:text-nav-text transition-colors"
          title="GitHub"
        >
          <Github class="w-6 h-6" />
        </a>
        <a
          href={AUTHOR_LINKEDIN}
          target="_blank"
          rel="noopener noreferrer"
          class="text-nav-text/80 hover:text-nav-text transition-colors"
          title="LinkedIn"
        >
          <Linkedin class="w-6 h-6" />
        </a>
        <a
          href={`mailto:${AUTHOR_EMAIL}`}
          class="text-nav-text/80 hover:text-nav-text transition-colors"
          title="Email"
        >
          <Mail class="w-6 h-6" />
        </a>
      </div>
    </nav>
  </div>
</header>

<script>
  import { setupMobileMenu } from "@/shared/scripts/mobile-menu";
  import { setupThemeToggle } from "@/shared/scripts/theme-toggle";

  document.addEventListener("DOMContentLoaded", () => {
    setupMobileMenu();
    setupThemeToggle();

    // Header scroll effect
    const header = document.getElementById("main-header");

    window.addEventListener("scroll", () => {
      const currentScroll = window.pageYOffset;

      if (currentScroll > 50) {
        header?.classList.add("shadow-lg", "backdrop-blur-sm", "bg-nav/95");
      } else {
        header?.classList.remove("shadow-lg", "backdrop-blur-sm", "bg-nav/95");
      }
    });
  });
</script>
